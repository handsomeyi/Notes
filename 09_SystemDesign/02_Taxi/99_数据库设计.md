# 广告

```sql
CREATE TABLE `tbl_ads` (
  `id` int(16) unsigned NOT NULL AUTO_INCREMENT,
  `down_load_url` varchar(255) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '视频/图片地址',
  `link_url` varchar(255) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '链接地址',
  `video_img` varchar(255) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '视频图片',
  `position_id` int(16) NOT NULL DEFAULT '0' COMMENT '广告位id',
  `start_time` datetime NOT NULL COMMENT '开始时间',
  `end_time` datetime NOT NULL COMMENT '结束时间',
  `city` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '展示城市',
  `name` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '广告名称',
  `platform` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '平台',
  `type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '1：视频；2：图片',
  `people_tag_id` tinyint(3) NOT NULL DEFAULT '0' COMMENT '人群模板id',
  `status` int(11) NOT NULL DEFAULT '0' COMMENT '1启用0停用',
  `operator_user` int(10) DEFAULT NULL COMMENT '操作人',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=95 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

-- 广告位置
DROP TABLE IF EXISTS `tbl_ad_position`;
CREATE TABLE `tbl_ad_position` (
  `id` int(16) unsigned NOT NULL AUTO_INCREMENT COMMENT '广告位id',
  `position_name` varchar(255) COLLATE utf8_unicode_ci NOT NULL COMMENT '广告位名称',
  `position_desc` text COLLATE utf8_unicode_ci NOT NULL COMMENT '广告位描述',
  `position_type` tinyint(1) NOT NULL COMMENT '广告位类型（1：客户端；2：大屏端）',
  `status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '状态（0：暂停；1：开启）',
  `most_count` tinyint(3) NOT NULL DEFAULT '0' COMMENT '广告上限',
  `content_type` tinyint(1) NOT NULL DEFAULT '0' COMMENT '内容类型（1：视频；2：图片）',
  `operator_user` int(10) NOT NULL DEFAULT '0' COMMENT '操作者',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=10 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

```

# 支付

## 阿里支付回调

```sql
-- 阿里支付回调信息
DROP TABLE IF EXISTS `tbl_alipay_callback_info`;
CREATE TABLE `tbl_alipay_callback_info` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `notify_time` varchar(50) COLLATE utf8_unicode_ci DEFAULT NULL COMMENT '通知时间',
  `notify_type` varchar(64) CHARACTER SET utf8 DEFAULT NULL COMMENT '通知类型',
  `notify_id` varchar(128) CHARACTER SET utf8 DEFAULT NULL COMMENT '通知校验ID',
  `app_id` varchar(32) CHARACTER SET utf8 DEFAULT NULL COMMENT '支付宝分配给开发者的应用ID',
  `charset` varchar(10) CHARACTER SET utf8 DEFAULT NULL COMMENT 'CHARSET',
  `version` varchar(3) CHARACTER SET utf8 DEFAULT NULL COMMENT '接口版本',
  `sign_type` varchar(10) CHARACTER SET utf8 DEFAULT NULL COMMENT '签名类型',
  `sign` varchar(256) CHARACTER SET utf8 DEFAULT NULL COMMENT '签名',
  `trade_no` varchar(64) CHARACTER SET utf8 DEFAULT NULL COMMENT '支付宝交易号',
  `out_trade_no` varchar(64) CHARACTER SET utf8 DEFAULT NULL COMMENT '商户订单号',
  `out_biz_no` varchar(64) CHARACTER SET utf8 DEFAULT NULL COMMENT '商户业务号',
  `buyer_id` varchar(16) CHARACTER SET utf8 DEFAULT NULL COMMENT '买家支付宝用户号',
  `buyer_logon_id` varchar(100) CHARACTER SET utf8 DEFAULT NULL COMMENT '买家支付宝账号',
  `seller_id` varchar(30) CHARACTER SET utf8 DEFAULT NULL COMMENT '卖家支付宝用户号',
  `seller_email` varchar(100) CHARACTER SET utf8 DEFAULT NULL COMMENT '卖家支付宝账号',
  `trade_status` varchar(32) CHARACTER SET utf8 DEFAULT NULL COMMENT '交易状态',
  `total_amount` varchar(11) COLLATE utf8_unicode_ci DEFAULT NULL COMMENT '订单金额',
  `receipt_amount` varchar(11) COLLATE utf8_unicode_ci DEFAULT NULL COMMENT '实收金额',
  `invoice_amount` varchar(11) COLLATE utf8_unicode_ci DEFAULT NULL COMMENT '开票金额',
  `buyer_pay_amount` varchar(11) COLLATE utf8_unicode_ci DEFAULT NULL COMMENT '付款金额',
  `point_amount` varchar(11) COLLATE utf8_unicode_ci DEFAULT NULL COMMENT '集分宝金额',
  `refund_fee` varchar(11) COLLATE utf8_unicode_ci DEFAULT NULL COMMENT '总退款金额',
  `subject` varchar(256) CHARACTER SET utf8 DEFAULT NULL COMMENT '订单标题',
  `body` varchar(256) CHARACTER SET utf8 DEFAULT NULL COMMENT '商品描述',
  `gmt_create` varchar(50) COLLATE utf8_unicode_ci DEFAULT NULL COMMENT '交易创建时间',
  `gmt_payment` varchar(50) COLLATE utf8_unicode_ci DEFAULT NULL COMMENT '交易付款时间',
  `gmt_refund` varchar(50) COLLATE utf8_unicode_ci DEFAULT NULL COMMENT '交易退款时间',
  `gmt_close` varchar(50) COLLATE utf8_unicode_ci DEFAULT NULL COMMENT '交易结束时间',
  `fund_bill_list` varchar(100) CHARACTER SET utf8 DEFAULT NULL COMMENT '支付金额信息',
  `passback_params` varchar(100) CHARACTER SET utf8 DEFAULT NULL COMMENT '回传参数',
  `voucher_detail_list` varchar(4) CHARACTER SET utf8 DEFAULT NULL COMMENT '优惠券信息',
  `create_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=135 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci ROW_FORMAT=DYNAMIC COMMENT='支付宝回调信息表';

```

## 微信支付回调

```sql
DROP TABLE IF EXISTS `tbl_weixinpay_callback_info`;
CREATE TABLE `tbl_weixinpay_callback_info` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `transaction_id` varchar(32) DEFAULT NULL COMMENT '微信订单号',
  `out_trade_no` varchar(32) DEFAULT NULL COMMENT '商户订单号',
  `total_fee` int(11) DEFAULT NULL,
  `body` varchar(200) DEFAULT NULL,
  `result_code` varchar(16) DEFAULT NULL COMMENT '业务结果',
  `err_code` varchar(45) DEFAULT NULL COMMENT '错误代码',
  `openid` varchar(128) DEFAULT NULL COMMENT '用户标识',
  `trade_type` varchar(45) DEFAULT NULL COMMENT '交易类型',
  `bank_type` varchar(16) DEFAULT NULL COMMENT '付款银行',
  `time_end` datetime DEFAULT NULL COMMENT '支付完成时间',
  `attach` varchar(128) DEFAULT NULL,
  `order_type` int(11) DEFAULT NULL COMMENT '订单类型 1："充值" ， 3："订单"， 4："缴纳押金"  6："违章缴费"',
  `status` int(11) DEFAULT '1' COMMENT '订单状态 1：未支付 ，2：已支付',
  `mch_id` varchar(32) DEFAULT NULL COMMENT '商户ID',
  `source` varchar(32) DEFAULT NULL COMMENT '来源iOS，Android',
  `create_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  KEY `INX_OUT_NO` (`out_trade_no`)
) ENGINE=InnoDB AUTO_INCREMENT=70 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC COMMENT='微信支付信息表';
```



# 优惠券配置

```sql
DROP TABLE IF EXISTS `tbl_coupon`;
CREATE TABLE `tbl_coupon` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT COMMENT '优惠券id',
  `status` int(4) unsigned NOT NULL DEFAULT '1' COMMENT '优惠券状态 0:禁用, 1:启用',
  `coupon_name` varchar(60) NOT NULL COMMENT '优惠券名称',
  `coupon_desc` varchar(250) NOT NULL DEFAULT '' COMMENT '优惠券描述',
  `coupon_type` int(4) unsigned NOT NULL DEFAULT '0' COMMENT '优惠方式 1:现金券, 3:专项券-免费送车券, 4:专项券-免费还车券 2:折扣券',
  `coupon_class_id` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '优惠券类型ID',
  `coupon_class_name` varchar(60) NOT NULL DEFAULT '' COMMENT '优惠券类型名称',
  `get_method` tinyint(3) unsigned NOT NULL DEFAULT '0' COMMENT '1,主动发放. 2,用户获取',
  `minimum_amount` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '订单最低金额',
  `reduction_amount` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '减免金额 仅现金券有此项',
  `maximum_amount` decimal(10,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '最高抵扣金额',
  `discount` decimal(4,2) NOT NULL DEFAULT '0.00' COMMENT '折扣比例',
  `effective_type` tinyint(3) unsigned NOT NULL DEFAULT '0' COMMENT '有效期类型 1：天数 ，2：时间段',
  `effective_day` smallint(5) unsigned NOT NULL DEFAULT '0' COMMENT '有效期天数',
  `enable_time` datetime NULL DEFAULT '0000-00-00 00:00:00' COMMENT '有效期开始时间',
  `expire_time` datetime NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '有效期结束时间',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
  `create_user` varchar(30) NOT NULL DEFAULT '' COMMENT '创建用户',
  `function_type` int(4) NOT NULL DEFAULT '1' COMMENT '功能类型 1:市场活动, 2:订单赔付',
  `total_number` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '总数量',
  `get_number` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '已获取',
  `used_number` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '已使用',
  `operator_id` int(10) unsigned DEFAULT '0' COMMENT '操作人ID',
  PRIMARY KEY (`id`),
  KEY `inx_fuction_type` (`function_type`)
) ENGINE=InnoDB AUTO_INCREMENT=13 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC COMMENT='优惠券配置表';
```

## 优惠券发放情况

```sql
DROP TABLE IF EXISTS `tbl_coupon_send_info`;
CREATE TABLE `tbl_coupon_send_info` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `send_num` int(11) NOT NULL COMMENT '发放数量',
  `start_time` datetime NOT NULL COMMENT '开始时间',
  `end_time` datetime NOT NULL COMMENT '结束时间',
  `operator_user` varchar(64) NOT NULL COMMENT '操作用户',
  `get_num` int(11) NOT NULL COMMENT '领取数量',
  `use_num` int(11) NOT NULL COMMENT '使用数量',
  `coupon_id` int(11) NOT NULL,
  `status` int(11) NOT NULL,
  `img_url` varchar(128) NOT NULL,
  `message` varchar(256) NOT NULL,
  `send_list` varchar(5120) NOT NULL,
  `send_time` datetime NOT NULL,
  `send_status` int(11) NOT NULL,
  `description` varchar(1024) NOT NULL COMMENT '优惠券文案',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

# 黑名单

```sql
DROP TABLE IF EXISTS `tbl_device_blacklist`;
CREATE TABLE `tbl_device_blacklist` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `device_type` char(1) NOT NULL DEFAULT '' COMMENT '1 android 2 ios3 other',
  `device_code` varchar(64) NOT NULL DEFAULT '' COMMENT '手机设备串码',
  `last_login_time` timestamp NULL DEFAULT NULL COMMENT '最后一次登录时间',
  `is_release` tinyint(11) unsigned NOT NULL DEFAULT '0' COMMENT '1 解禁，0 未解禁',
  `phones` mediumtext COMMENT '欠款手机号',
  `memo` mediumtext NOT NULL COMMENT '备注',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT 'create',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'update',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8 COMMENT='设备黑名单';
```

# 司机信息

## 详细信息

```sql
DROP TABLE IF EXISTS `tbl_driver_base_info`;
CREATE TABLE `tbl_driver_base_info` (
  `id` int(11) NOT NULL,
  `mobile_operator` varchar(255) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '手机运营商',
  `company_logo` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '公司标识',
  `administrative_code` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '注册行政地区代码',
  `birthday` date DEFAULT NULL COMMENT '驾驶员出生日期',
  `country` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '国籍',
  `national` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '驾驶员民族',
  `driving_licence_number` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '驾驶证编号',
  `marital_status` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '婚姻状况',
  `foreign_language_ability` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '外语能力',
  `app_version` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '使用APP版本号',
  `map_type` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '使用地图类型',
  `education_background` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '驾驶员学历',
  `household_registration_authority` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '户口   登记机关名称',
  `registered_permanent_residence_address` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '户口   住址',
  `address` varchar(736) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '现居地址',
  `address_longitude` varchar(32) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '现居地址经度',
  `address_latitude` varchar(32) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '现居地址纬度',
  `driver_img_file_number` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '驾驶员照片文件编号',
  `driver_license` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '机动车驾驶员证',
  `driver_license_scan_copy_number` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '机动车驾驶证扫描件文件编号',
  `driving_type` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '准驾车型',
  `first_get_driver_license_date` datetime DEFAULT NULL COMMENT '初次领取驾驶证日期',
  `driver_license_validity_start` datetime DEFAULT NULL COMMENT '驾驶证有效期起',
  `driver_license_validity_end` datetime DEFAULT NULL COMMENT '驾驶证有效期止',
  `is_taxi_driver` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '是否巡游出租车驾驶员',
  `network_reservation_taxi_driver_license_number` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '网络预约出租汽车驾驶员证号',
  `network_reservation_taxi_driver_license_issuing_agencies` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '网络预约出租汽车驾驶员证发证机构',
  `certificate_issuing_date` datetime DEFAULT NULL COMMENT '资格证发证日期',
  `first_qualification_date` datetime DEFAULT NULL COMMENT '初次领取资格证日期',
  `qualification_certificate_validity_start` datetime DEFAULT NULL COMMENT '资格证有效期起',
  `qualification_certificate_validity_end` datetime DEFAULT NULL COMMENT '资格证有效期止',
  `reported_date` datetime DEFAULT NULL COMMENT '报备日期',
  `is_full_time_driver` int(11) NOT NULL DEFAULT '0' COMMENT '是否专职驾驶员',
  `is_in_driver_blacklist` int(11) NOT NULL DEFAULT '0' COMMENT '是否在黑名单',
  `service_type` int(11) NOT NULL DEFAULT '0' COMMENT '服务类型',
  `company` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '驾驶员合同（或协议）签署公司',
  `contract_start_date` datetime DEFAULT NULL COMMENT '合同开始时间',
  `contract_end_date` datetime DEFAULT NULL COMMENT '合同结束时间',
  `emergency_contact` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '紧急联系人',
  `emergency_contact_phone_number` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '紧急联系人电话',
  `emergency_contact_address` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '紧急联系人地址',
  `training_courses` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '培训课名称',
  `training_courses_date` datetime DEFAULT NULL COMMENT '培训课程日期',
  `training_courses_start_date` datetime DEFAULT NULL COMMENT '培训开始日期',
  `training_courses_end_date` datetime DEFAULT NULL COMMENT '培训结束日期',
  `training_courses_time` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '培训时长',
  `bank_name` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '开户行',
  `bank_card_number` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '银行卡号',
  `note` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '备注',
  `qualification_certificate_img` varchar(256) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '从业资格证照片',
  `other_img1` varchar(128) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '其他一',
  `other_img2` varchar(128) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '其他二',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
  PRIMARY KEY (`id`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;
```

## 司机信息表

```sql
DROP TABLE IF EXISTS `tbl_driver_info`;
CREATE TABLE `tbl_driver_info` (
  `id` int(16) unsigned NOT NULL AUTO_INCREMENT,
  `phone_number` varchar(32) NOT NULL DEFAULT '' COMMENT '司机手机号',
  `driver_leader` int(11) unsigned DEFAULT '0' COMMENT '司机主管',
  `driver_name` varchar(16) NOT NULL DEFAULT '' COMMENT '司机姓名',
  `register_time` datetime DEFAULT NULL COMMENT '注册时间',
  `balance` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '余额',
  `gender` int(2) unsigned NOT NULL DEFAULT '0' COMMENT '性别',
  `car_id` int(16) unsigned DEFAULT NULL COMMENT '车辆id',
  `is_following` int(1) NOT NULL DEFAULT '0' COMMENT '是否是顺风单0否 1是',
  `work_status` int(2) unsigned NOT NULL DEFAULT '0' COMMENT '司机工作状态\r\n0：非出车状态，\r\n1：出车，未接订单，\r\n2：出车，接到订单,\r\n3：暂停接单',
  `head_img` varchar(256) NOT NULL DEFAULT '' COMMENT '司机头像',
  `city_code` varchar(8) NOT NULL DEFAULT '' COMMENT '城市代码',
  `bind_time` datetime DEFAULT NULL COMMENT '绑定时间',
  `use_status` int(2) unsigned NOT NULL DEFAULT '0' COMMENT '启用停用状态，0：停用，1：启用',
  `cs_work_status` int(2) unsigned NOT NULL DEFAULT '0' COMMENT '车机工作状态\r\n0：车机未登录登录\r\n1：车机登录\r\n2：车机听单\r\n3：车机暂停听单\r\n4：车机收车\r\n\r\n',
  `sign_status` int(2) NOT NULL DEFAULT '1' COMMENT '1：已签约，0：已解约',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
  PRIMARY KEY (`id`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=38 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC COMMENT='司机信息表';

```

## 司机信息审核记录

```sql
DROP TABLE IF EXISTS `tbl_driver_licence_info`;
CREATE TABLE `tbl_driver_licence_info` (
  `id` int(16) unsigned NOT NULL AUTO_INCREMENT COMMENT '审核记录id',
  `driver_id` int(16) NOT NULL DEFAULT '0' COMMENT '司机id',
  `main_driving_license` varchar(256) NOT NULL DEFAULT '' COMMENT '驾照主页照片地址',
  `vice_driving_license` varchar(256) NOT NULL DEFAULT '' COMMENT '驾照副页照片地址',
  `all_driving_license` varchar(256) NOT NULL DEFAULT '' COMMENT '驾照正副页照片地址',
  `group_driving_license` varchar(256) NOT NULL DEFAULT '' COMMENT '手持驾照照片地址',
  `identity_card_id` varchar(32) NOT NULL DEFAULT '' COMMENT '身份证',
  `main_idcard_license` varchar(256) NOT NULL DEFAULT '' COMMENT '身份证正面照',
  `vice_idcard_license` varchar(256) NOT NULL DEFAULT '' COMMENT '身份证副页照片地址',
  `group_idcard_license` varchar(256) NOT NULL DEFAULT '' COMMENT '手持身份证照片',
  `plate_number` varchar(16) NOT NULL DEFAULT '' COMMENT '车牌号',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
  PRIMARY KEY (`id`),
  KEY `fk_reference_2` (`driver_id`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=38 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC COMMENT='司机驾驶证信息';
```

## 司机车辆绑定

```sql
DROP TABLE IF EXISTS `tbl_car_driver_bind_record`;
CREATE TABLE `tbl_car_driver_bind_record` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `driver_info_id` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '司机ID',
  `car_info_id` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '车辆ID',
  `operator_user` varchar(64) COLLATE utf8_unicode_ci NOT NULL DEFAULT 'system',
  `type` int(11) NOT NULL COMMENT '1绑定0解绑',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00',
  `bind_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '绑定时间',
  `unbind_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '解绑时间',
  `total_mile` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '车辆总里程',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

-- 车辆
DROP TABLE IF EXISTS `tbl_car_info`;
CREATE TABLE `tbl_car_info` (
  `id` int(10) NOT NULL AUTO_INCREMENT COMMENT '车辆id',
  `plate_number` varchar(16) NOT NULL DEFAULT '' COMMENT '车牌号',
  `operation_status` int(2) NOT NULL DEFAULT '0' COMMENT '运营状态：-1，删除 0，上架 1，下架 2，待整备',
  `publish_time` datetime DEFAULT NULL COMMENT '上架时间',
  `full_name` varchar(64) NOT NULL DEFAULT '' COMMENT '车辆全名',
  `color` varchar(30) NOT NULL DEFAULT '' COMMENT '车身颜色',
  `car_img` varchar(256) NOT NULL DEFAULT '' COMMENT '汽车图片',
  `city_code` varchar(32) NOT NULL DEFAULT '' COMMENT '城市',
  `car_type_id` int(16) unsigned NOT NULL DEFAULT '0' COMMENT '车辆类型',
  `car_level_id` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '车辆级别',
  `regist_date` datetime DEFAULT NULL COMMENT '上牌日期',
  `insurance_start_date` datetime DEFAULT NULL COMMENT '保险生效日期',
  `insurance_end_date` datetime DEFAULT NULL COMMENT '保险失效日期',
  `annual_end_date` datetime DEFAULT NULL COMMENT '年检到期日期',
  `car_license_img` varchar(256) NOT NULL DEFAULT '' COMMENT '行驶本图片地址',
  `is_free_order` int(2) DEFAULT '0' COMMENT '是否开启顺风单0：停用，1：启用',
  `remark` varchar(256) NOT NULL DEFAULT '' COMMENT '备注',
  `use_status` int(2) NOT NULL DEFAULT '0' COMMENT '启用停用状态，0：停用，1：启用',
  `large_screen_device_code` varchar(256) NOT NULL DEFAULT '' COMMENT '大屏编号',
  `large_screen_device_brand` varchar(64) NOT NULL DEFAULT '' COMMENT '大屏品牌名称',
  `car_screen_device_code` varchar(256) NOT NULL DEFAULT '' COMMENT '车机/脑设备号',
  `car_screen_device_brand` varchar(64) NOT NULL DEFAULT '' COMMENT '车机/脑品牌名称',
  `operator_id` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '操作人ID',
  `total_mile` int(11) NOT NULL DEFAULT '0' COMMENT '行驶总里程单位：km',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=50 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC;
```

# 用户

## 用户信息

```sql
DROP TABLE IF EXISTS `tbl_sys_user`;
CREATE TABLE `tbl_sys_user` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `username` varchar(50) NOT NULL DEFAULT '',
  `password` varchar(100) NOT NULL DEFAULT '',
  `salt` varchar(15) NOT NULL DEFAULT '' COMMENT '密码的盐',
  `phone` varchar(32) NOT NULL DEFAULT '',
  `is_deleted` tinyint(1) NOT NULL DEFAULT '0',
  `status` tinyint(1) NOT NULL DEFAULT '1',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `last_login_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE CURRENT_TIMESTAMP COMMENT '最后登录时间',
  `modify_id` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '最后修改人ID',
  `last_update_password_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=31 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC;
```

## 用户优惠券拥有信息

```sql
DROP TABLE IF EXISTS `tbl_user_coupon`;
CREATE TABLE `tbl_user_coupon` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '领取记录ID',
  `passenger_id` int(11) NOT NULL DEFAULT '0' COMMENT '乘客ID',
  `phone_number` varchar(20) NOT NULL DEFAULT '' COMMENT '电话号码',
  `order_id` varchar(32) NOT NULL DEFAULT '' COMMENT '关联订单号',
  `coupon_id` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '优惠券ID',
  `coupon_name` varchar(30) DEFAULT '',
  `coupon_type` tinyint(3) unsigned NOT NULL DEFAULT '0' COMMENT '优惠券类型 1:现金券, 2:专项券-免费送车券, 3:专项券-免费还车券 4:折扣券',
  `get_method` tinyint(3) unsigned NOT NULL DEFAULT '0' COMMENT '  1,主动发放. 2,用户获取',
  `enable_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '优惠券起效时间',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '获取时间',
  `expire_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '过期时间',
  `update_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE CURRENT_TIMESTAMP COMMENT '使用时间',
  `use_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '使用时间',
  `is_use` tinyint(3) unsigned NOT NULL DEFAULT '0' COMMENT '状态 0:未使用, 1:已使用',
  `minimum_amount` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '最低消费金额',
  `reduction_amount` decimal(10,2) NOT NULL DEFAULT '0.00' COMMENT '减免金额(现金券：能抵扣的金额,折扣券：最高能抵扣的金额)',
  `discount` decimal(4,2) NOT NULL DEFAULT '0.00' COMMENT '折扣8,7.5',
  `function_type` int(4) NOT NULL DEFAULT '0' COMMENT '功能类型 1:市场活动, 2:订单赔付',
  `indemnity_record_id` int(10) NOT NULL DEFAULT '0' COMMENT '赔付记录ID',
  `activity_tag` varchar(30) NOT NULL DEFAULT '' COMMENT '活动标签',
  `activity_id` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '活动ID',
  PRIMARY KEY (`id`),
  KEY `INX_PHONE` (`phone_number`),
  KEY `INX_COUPON` (`coupon_id`)
) ENGINE=InnoDB AUTO_INCREMENT=1252 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC COMMENT='用户优惠券表';
```





## 评价反馈记录

```sql
DROP TABLE IF EXISTS `tbl_evaluate_driver`;
CREATE TABLE `tbl_evaluate_driver` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '自增主键',
  `grade` int(2) unsigned NOT NULL DEFAULT '0' COMMENT '分数',
  `content` varchar(500) NOT NULL DEFAULT '' COMMENT '评价内容',
  `order_id` int(10) unsigned NOT NULL COMMENT '订单ID',
  `passenger_id` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '乘客ID',
  `driver_id` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '司机ID',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
  PRIMARY KEY (`id`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=138 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC COMMENT='客户的订单评价表';

DROP TABLE IF EXISTS `tbl_feedback`;
CREATE TABLE `tbl_feedback` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `user_id` int(11) NOT NULL,
  `user_name` varchar(100) DEFAULT '',
  `phone` varchar(64) NOT NULL,
  `terminal` char(255) NOT NULL DEFAULT '' COMMENT '端\r\n1:乘客\r\n2,司机\r\n3,车机\r\n4,大屏',
  `category` char(255) NOT NULL DEFAULT '' COMMENT '问题类型',
  `content` varchar(255) DEFAULT NULL COMMENT '反馈内容 ',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=14 DEFAULT CHARSET=utf8 COMMENT='用户反馈记录表';
```

## 发票

```sql
DROP TABLE IF EXISTS `tbl_invoice_record`;
CREATE TABLE `tbl_invoice_record` (
  `id` int(16) NOT NULL AUTO_INCREMENT COMMENT '发票ID',
  `passenger_info_id` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '乘客ID',
  `order_id_list` varchar(512) NOT NULL COMMENT '订单list，逗号分隔',
  `invoice_price` decimal(10,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '发票总价',
  `invoice_status` tinyint(3) unsigned NOT NULL DEFAULT '0' COMMENT '1：待开票（申请开票）,\r\n2：待邮寄,\r\n3：已邮寄,\r\n4：已撤销,',
  `invoice_type` tinyint(3) unsigned NOT NULL DEFAULT '0' COMMENT '发票类型：1：普票，2：专票',
  `invoice_body` tinyint(3) unsigned NOT NULL DEFAULT '0' COMMENT '发票主体：1：个人，2：企业',
  `invoice_title` varchar(128) NOT NULL DEFAULT '' COMMENT '发票抬头',
  `invoice_content` varchar(128) NOT NULL DEFAULT '' COMMENT '发票内容',
  `taxpayer_id` varchar(32) NOT NULL DEFAULT '' COMMENT '纳税人识别号',
  `reg_address` varchar(256) NOT NULL DEFAULT '' COMMENT '注册地址',
  `reg_phone` varchar(32) NOT NULL DEFAULT '' COMMENT '注册电话',
  `deposit_bank` varchar(218) NOT NULL DEFAULT '' COMMENT '开户银行',
  `bank_account` varchar(32) NOT NULL DEFAULT '' COMMENT '银行账号',
  `receiver_name` varchar(32) NOT NULL DEFAULT '' COMMENT '收件人姓名',
  `receiver_phone` varchar(16) NOT NULL DEFAULT '' COMMENT '收件人电话',
  `receiver_address` varchar(256) NOT NULL DEFAULT '' COMMENT '收件人地址',
  `create_time` datetime NULL DEFAULT '0000-00-00 00:00:00' COMMENT '申请开票时间',
  `express_company` tinyint(3) unsigned NOT NULL DEFAULT '0' COMMENT '快递公司',
  `express_num` varchar(32) NOT NULL DEFAULT '' COMMENT '快递号',
  `express_time` datetime NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '邮寄时间',
  `reject_id` tinyint(3) unsigned NOT NULL DEFAULT '0' COMMENT '驳回原因ID',
  `cancel_desc` varchar(32) NOT NULL DEFAULT '' COMMENT '撤销原因',
  `email` varchar(128) NOT NULL DEFAULT '' COMMENT '邮件地址',
  `invoice_number` varchar(32) NOT NULL DEFAULT '' COMMENT '发票号',
  `express_company_name` varchar(128) NOT NULL DEFAULT '' COMMENT '快递公司名称',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=22 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC;
```

## 用户设置地址

```sql
DROP TABLE IF EXISTS `tbl_passenger_address`;
CREATE TABLE `tbl_passenger_address` (
  `id` int(16) NOT NULL AUTO_INCREMENT,
  `passenger_info_id` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '乘客id',
  `latitude` double(10,6) DEFAULT NULL COMMENT '地址纬度',
  `longitude` double(10,6) DEFAULT NULL COMMENT '地址经度',
  `address_name` varchar(64) DEFAULT '' COMMENT '详细地址',
  `type` int(2) DEFAULT NULL COMMENT '0:家，1：公司',
  `address_desc` varchar(2048) DEFAULT '' COMMENT '地址描述',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=107 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC;
```



# 订单

## 订单信息

```sql
DROP TABLE IF EXISTS `tbl_order`;
CREATE TABLE `tbl_order` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `order_number` varchar(32) NOT NULL DEFAULT '' COMMENT '订单号',
  `passenger_info_id` int(10) unsigned NOT NULL DEFAULT '0' COMMENT '乘客id',
  `passenger_phone` varchar(64) NOT NULL COMMENT '乘客电话',
  `device_code` varchar(64) NOT NULL DEFAULT '' COMMENT '乘客设备号',
  `driver_id` int(10) unsigned DEFAULT NULL COMMENT '司机id',
  `driver_status` int(2) unsigned DEFAULT '0' COMMENT '司机状态   \r\n0：没有司机接单   \r\n1：司机接单  \r\n2.  去接乘客 \r\n3：司机到达上车点   \r\n4：开始行程   \r\n5：结束行程  \r\n6：发起收款  \r\n7：取消',
  `driver_phone` varchar(64) DEFAULT NULL COMMENT '司机电话',
  `car_id` int(10) unsigned DEFAULT NULL COMMENT '车辆id',
  `plate_number` varchar(16) DEFAULT NULL COMMENT '车牌号',
  `user_longitude` varchar(32) NOT NULL COMMENT '用户位置经度',
  `user_latitude` varchar(32) NOT NULL COMMENT '用户位置纬度',
  `start_longitude` varchar(32) NOT NULL COMMENT '乘客下单起点经度',
  `start_latitude` varchar(32) NOT NULL COMMENT '乘客下单起点纬度',
  `start_address` varchar(128) NOT NULL COMMENT '起点名称',
  `end_address` varchar(128) NOT NULL COMMENT '终点地址名称',
  `start_time` timestamp NULL DEFAULT NULL COMMENT '乘客下单时间',
  `order_start_time` timestamp NULL DEFAULT NULL COMMENT '订单开始时间',
  `end_longitude` varchar(32) NOT NULL COMMENT '乘客下单终点经度',
  `end_latitude` varchar(32) NOT NULL COMMENT '乘客下单终点纬度',
  `driver_grab_time` timestamp NULL DEFAULT NULL COMMENT '司机抢单时间',
  `driver_start_time` timestamp NULL DEFAULT NULL COMMENT '司机去接乘客出发时间',
  `driver_arrived_time` timestamp NULL DEFAULT NULL COMMENT '司机到达时间',
  `pick_up_passenger_longitude` varchar(32) DEFAULT '' COMMENT '去接乘客经度',
  `pick_up_passenger_latitude` varchar(32) DEFAULT '' COMMENT '去接乘客纬度',
  `pick_up_passenger_address` varchar(300) DEFAULT '' COMMENT '去接乘客地点',
  `receive_passenger_time` timestamp NULL DEFAULT NULL COMMENT '接到乘客时间',
  `receive_passenger_longitude` varchar(32) NOT NULL DEFAULT '' COMMENT '接到乘客经度',
  `receive_passenger_latitude` varchar(32) NOT NULL DEFAULT '' COMMENT '接到乘客纬度',
  `passenger_getoff_time` timestamp NULL DEFAULT NULL COMMENT '乘客下车时间',
  `passenger_getoff_longitude` varchar(32) DEFAULT NULL COMMENT '乘客下车经度',
  `passenger_getoff_latitude` varchar(32) DEFAULT NULL COMMENT '乘客下车纬度',
  `other_name` varchar(16) DEFAULT NULL COMMENT '他人姓名 （乘车人）',
  `other_phone` varchar(64) DEFAULT NULL COMMENT '他人电话　(乘车人）',
  `order_type` int(2) unsigned DEFAULT NULL COMMENT '订单类型：1：自己叫车，2：他人叫车',
  `service_type` int(2) unsigned NOT NULL COMMENT '叫车订单类型，\r\n1：实时订单，\r\n2：预约订单，\r\n3：接机单，\r\n4：送机单，\r\n5：日租，\r\n6：半日租',
  `order_channel` int(2) unsigned NOT NULL DEFAULT '1' COMMENT '订单渠道 \r\n1.自有订单\r\n2.高德\r\n3.飞猪',
  `status` int(2) NOT NULL COMMENT '订单状态 0: 订单预估 1：订单开始 2：司机接单 3：去接乘客 4：司机到达乘客起点 5：乘客上车，司机开始行程 6：到达目的地，行程结束，未支付 7：发起收款 8: 支付完成 9.乘客取消订单',
  `transaction_id` varchar(32) DEFAULT NULL COMMENT '商户交易id',
  `mapping_id` varchar(64) DEFAULT NULL COMMENT '订单状态 0: 订单预估 1：订单开始 2：司机接单 3：去接乘客 4：司机到达乘客起点 5：乘客上车，司机开始行程 6：到达目的地，行程结束，未支付 7：发起收款 8: 支付完成 9.订单取消',
  `mapping_number` varchar(32) DEFAULT NULL COMMENT '关联号码',
  `merchant_id` varchar(32) DEFAULT NULL COMMENT '商户id',
  `is_evaluate` int(2) NOT NULL DEFAULT '0' COMMENT '乘客是否评价，0：未评价，1：已评价',
  `invoice_type` int(2) unsigned NOT NULL DEFAULT '1' COMMENT '发票状态：\r\n1：未开票，\r\n2：申请开票，\r\n3：开票中，\r\n4：已开票,\r\n5：退回,',
  `is_annotate` int(2) unsigned NOT NULL DEFAULT '0' COMMENT '通知客服状态\r\n0，未通知  \r\n1,  已通知',
  `source` varchar(64) NOT NULL COMMENT '设备来源\r\n1: ios\r\n2:android\r\n3.other',
  `use_coupon` int(2) unsigned NOT NULL DEFAULT '0' COMMENT '是否使用优惠券 \r\n0:未使用  1:使用',
  `cancel_order_type` int(2) unsigned DEFAULT NULL COMMENT '取消原因类型id',
  `pay_type` int(1) DEFAULT NULL COMMENT '1:余额\r\n2.微信\r\n3.支付宝',
  `is_paid` int(2) unsigned NOT NULL DEFAULT '0' COMMENT '是否已支付 0：未支付  1：已支付',
  `is_cancel` int(2) unsigned NOT NULL DEFAULT '0' COMMENT '是否取消  0：未取消   1：已取消',
  `is_adjust` int(2) unsigned NOT NULL DEFAULT '0' COMMENT '调帐状态  0：未调帐  1:调账中 2.调账完毕',
  `is_dissent` int(2) unsigned NOT NULL DEFAULT '0' COMMENT '是否疑义订单 0：否  1：是',
  `is_manual` int(1) NOT NULL DEFAULT '0' COMMENT '是否人工派单0 否 1 原来无司机, 人工派 2原来有司机，改派',
  `is_following` int(1) NOT NULL DEFAULT '0' COMMENT '是否是顺风单0否 1是',
  `is_fake_success` int(1) NOT NULL DEFAULT '0' COMMENT '是否是假成功单0 否 1是',
  `memo` varchar(500) CHARACTER SET utf8mb4 NOT NULL DEFAULT '' COMMENT '备忘录',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT 'create_time',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'update_time',
  `user_feature` int(2) DEFAULT '0' COMMENT '1：儿童用车\r\n2：女性用车',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1967 DEFAULT CHARSET=utf8 ROW_FORMAT=COMPACT COMMENT='订单表';
```

## 订单支付

```sql
DROP TABLE IF EXISTS `tbl_order_payment`;
CREATE TABLE `tbl_order_payment` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `order_id` int(10) unsigned NOT NULL COMMENT '订单id',
  `pay_type` int(2) unsigned NOT NULL DEFAULT '0' COMMENT '支付类型：1微信，2账户余额，4支付宝',
  `total_price` double(10,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '总金额',
  `balance_price` double(10,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '余额支付金额',
  `wechat_price` double(10,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '微信支付金额',
  `alipay_price` double(10,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '支付宝金额',
  `user_coupon_id` int(11) unsigned NOT NULL DEFAULT '0' COMMENT '用户获得优惠券id,此时不是优惠券id，是用户优惠券关联id',
  `coupon_reduce_price` double(10,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '优惠券减免金额',
  `paid_price` double(10,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '已支付金额',
  `remain_price` double(10,2) unsigned NOT NULL DEFAULT '0.00' COMMENT '剩余支付的金额',
  `tail_price` double(10,2) NOT NULL DEFAULT '0.00' COMMENT '尾款价格',
  `replenish_price` double(10,2) NOT NULL DEFAULT '0.00' COMMENT '补扣价格',
  `pay_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT '支付时间',
  `create_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `update_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=254 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC COMMENT='订单支付表';
```

## 订单小信息

```sql
ROP TABLE IF EXISTS `tbl_order_points`;
CREATE TABLE `tbl_order_points` (
  `id` int(16) unsigned NOT NULL AUTO_INCREMENT,
  `driver_id` int(16) DEFAULT NULL COMMENT '司机Id',
  `car_id` int(16) DEFAULT NULL COMMENT '车辆Id',
  `order_id` int(16) DEFAULT NULL COMMENT '订单id',
  `points` text,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=60 DEFAULT CHARSET=utf8;
```



## 订单计价明细

```sql
DROP TABLE IF EXISTS `tbl_order_rule_price`;
CREATE TABLE `tbl_order_rule_price` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `order_id` int(10) NOT NULL COMMENT '订单id',
  `category` varchar(1) NOT NULL COMMENT '价格类型：0预估，1实际',
  `total_price` double(10,2) NOT NULL COMMENT '总价',
  `total_distance` double(10,2) NOT NULL COMMENT '总距离（公里）',
  `total_time` double(10,0) NOT NULL COMMENT '总时间（分钟）',
  `city_code` varchar(32) NOT NULL COMMENT '城市编码',
  `city_name` varchar(64) NOT NULL COMMENT '城市名称',
  `service_type_id` int(2) NOT NULL COMMENT '服务类型id',
  `service_type_name` varchar(64) NOT NULL COMMENT '服务类型名称',
  `channel_id` int(10) NOT NULL COMMENT '渠道id',
  `channel_name` varchar(64) NOT NULL COMMENT '渠道名称',
  `car_level_id` int(10) NOT NULL COMMENT '车辆级别id',
  `car_level_name` varchar(64) NOT NULL COMMENT '车辆级别名称',
  `base_price` double(10,2) NOT NULL COMMENT '基础价格',
  `base_kilo` double(10,2) NOT NULL COMMENT '基础价格包含公里数',
  `base_minute` double(10,2) NOT NULL COMMENT '基础价格包含时长数（分钟）',
  `lowest_price` double(10,2) NOT NULL COMMENT '最低消费',
  `night_start` time DEFAULT NULL COMMENT '夜间时间段开始',
  `night_end` time DEFAULT NULL COMMENT '夜间时间段结束',
  `night_per_kilo_price` double(10,2) DEFAULT NULL COMMENT '夜间超公里加收单价',
  `night_per_minute_price` double(10,2) DEFAULT NULL COMMENT '夜间超时间加收单价',
  `night_distance` double(10,2) NOT NULL COMMENT '夜间行驶总里程（公里）',
  `night_time` double(10,2) NOT NULL COMMENT '夜间行驶总时间（分钟）',
  `night_price` double(10,2) NOT NULL COMMENT '夜间服务费',
  `beyond_start_kilo` double(10,2) NOT NULL COMMENT '远途起算公里',
  `beyond_per_kilo_price` double(10,2) NOT NULL COMMENT '远途单价',
  `beyond_distance` double(8,2) NOT NULL COMMENT '远途距离，超出远途的公里数',
  `beyond_price` double(10,2) NOT NULL COMMENT '远途费',
  `per_kilo_price` double(10,2) NOT NULL COMMENT '超公里单价(每公里单价)',
  `path` double(10,2) NOT NULL COMMENT '(不包含起步)行驶总里程（公里）或分段计价合计里程（公里）',
  `path_price` double(10,2) NOT NULL COMMENT '(不包含起步)行驶总里程价格或分段计价合计价格',
  `per_minute_price` double(10,2) NOT NULL COMMENT '超时间单价(每分钟单价)或分段计价默认的每分钟单价',
  `duration` double(10,2) NOT NULL COMMENT '(不包含起步)行驶时长（分钟）或分段计价合计时长（分钟）',
  `duration_price` double(10,2) NOT NULL COMMENT '(不包含起步)行驶时长价格或分段计价合计时间价格',
  `rest_duration` double(10,2) NOT NULL DEFAULT '0.00' COMMENT '其他时段时长合计',
  `rest_duration_price` double(10,2) NOT NULL DEFAULT '0.00' COMMENT '其他时段时长费用合计',
  `rest_distance` double(10,2) NOT NULL DEFAULT '0.00' COMMENT '其他时段距离合计',
  `rest_distance_price` double(10,2) NOT NULL DEFAULT '0.00' COMMENT '其他时段距离费用合计',
  `road_price` double(10,2) NOT NULL DEFAULT '0.00' COMMENT '过路费',
  `parking_price` double(10,2) NOT NULL DEFAULT '0.00' COMMENT '停车费',
  `other_price` double(10,2) NOT NULL DEFAULT '0.00' COMMENT '其它费用',
  `dynamic_discount_rate` double(10,2) NOT NULL DEFAULT '0.00' COMMENT '动态调价的折扣率(0-1 两小数)',
  `dynamic_discount` double(10,2) NOT NULL DEFAULT '0.00' COMMENT '动态调价的金额',
  `supplement_price` double(10,2) NOT NULL DEFAULT '0.00' COMMENT '最低消费补足的费用',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT 'create_time',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'update_time',
  PRIMARY KEY (`id`),
  KEY `idx_order_id` (`order_id`)
) ENGINE=InnoDB AUTO_INCREMENT=2196 DEFAULT CHARSET=utf8 COMMENT='计费明细表';

-- ----------------------------
-- Table structure for tbl_order_rule_price_detail
-- ----------------------------
DROP TABLE IF EXISTS `tbl_order_rule_price_detail`;
CREATE TABLE `tbl_order_rule_price_detail` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `order_id` int(10) NOT NULL COMMENT '订单id',
  `category` varchar(1) NOT NULL COMMENT '价格类型：0预约，1实际',
  `start_hour` int(2) NOT NULL COMMENT '时间段-开始',
  `end_hour` int(2) NOT NULL COMMENT '时间段-结束',
  `per_kilo_price` double(10,2) NOT NULL COMMENT '超公里单价(每公里单价)',
  `per_minute_price` double(10,2) NOT NULL COMMENT '超时间单价(每分钟单价)',
  `duration` double(10,2) NOT NULL COMMENT '该时间段的时间统计',
  `time_price` double(10,2) NOT NULL COMMENT '该时间段的时间价格合计',
  `distance` double(10,2) NOT NULL COMMENT '该时间段的距离统计',
  `distance_price` double(10,2) NOT NULL COMMENT '该时间段的距离价格合计',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT 'create_time',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'update_time',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='分段计时计费明细表';
```



## 优惠券使用记录

```sql
DROP TABLE IF EXISTS `tbl_order_use_coupon`;
CREATE TABLE `tbl_order_use_coupon` (
  `id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `order_id` int(11) unsigned NOT NULL COMMENT '订单id',
  `coupon_id` int(11) unsigned NOT NULL COMMENT '优惠券Id',
  `category` char(1) NOT NULL DEFAULT '0' COMMENT '0:预估 1，实际',
  `coupon_money` float(10,2) NOT NULL DEFAULT '0.00' COMMENT '优惠券金额',
  `after_use_coupon_moeny` float(10,2) DEFAULT NULL COMMENT '使用优惠券后订单金额',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=467 DEFAULT CHARSET=utf8 COMMENT='订单优惠券使用记录';
```

# 计价规则

```sql
DROP TABLE IF EXISTS `tbl_charge_rule`;
CREATE TABLE `tbl_charge_rule` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `city_code` varchar(32) NOT NULL DEFAULT '' COMMENT '城市编码',
  `service_type_id` int(10) NOT NULL COMMENT '服务类型',
  `channel_id` int(10) NOT NULL COMMENT '渠道名称',
  `car_level_id` int(10) NOT NULL COMMENT '车辆级别',
  `lowest_price` double(10,2) NOT NULL COMMENT '基础价',
  `base_price` double(10,2) NOT NULL COMMENT '起步价',
  `base_kilo` double(10,2) NOT NULL COMMENT '基础价格包含公里数',
  `base_minutes` double(10,2) NOT NULL COMMENT '基础价格包含时长数(分钟)',
  `per_kilo_price` double(10,2) NOT NULL COMMENT '超公里单价(每公里单价)',
  `per_minute_price` double(10,2) NOT NULL COMMENT '超时间单价(每分钟单价)',
  `beyond_start_kilo` double(10,2) NOT NULL COMMENT '远途起算公里',
  `beyond_per_kilo_price` double(10,2) NOT NULL COMMENT '远途单价',
  `night_start` time DEFAULT NULL COMMENT '夜间时间段开始',
  `night_end` time DEFAULT NULL COMMENT '夜间时间段结束',
  `night_per_kilo_price` double(10,2) DEFAULT NULL COMMENT '夜间超公里加收单价',
  `night_per_minute_price` double(10,2) DEFAULT NULL COMMENT '夜间超时间加收单价',
  `effective_time` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE CURRENT_TIMESTAMP COMMENT '生效时间',
  `active_status` int(11) NOT NULL DEFAULT '0' COMMENT '生效状态 0已失效 1未失效',
  `is_unuse` int(11) NOT NULL DEFAULT '0' COMMENT '是否不可用 0可用 1不可用',
  `creator_id` int(10) NOT NULL DEFAULT '0' COMMENT '创建人id',
  `operator_id` int(10) NOT NULL DEFAULT '0' COMMENT '操作人id',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT 'create_time',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'update_time',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8 COMMENT='计费规则表';


DROP TABLE IF EXISTS `tbl_charge_rule_detail`;
CREATE TABLE `tbl_charge_rule_detail` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `rule_id` int(10) NOT NULL,
  `start` int(2) NOT NULL COMMENT '时间段开始',
  `end` int(2) NOT NULL COMMENT '时间段结束',
  `per_kilo_price` double(10,2) NOT NULL COMMENT '超公里单价',
  `per_minute_price` double(10,2) NOT NULL COMMENT '超时间单价',
  `is_delete` int(10) NOT NULL DEFAULT '0' COMMENT '是否删除 0未删除 1已删除',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='计费规则时间段表';

```

# 管理



## 短信模板条目

```sql
DROP TABLE IF EXISTS `tbl_sms_app_template`;
CREATE TABLE `tbl_sms_app_template` (
  `id` int(10) NOT NULL AUTO_INCREMENT,
  `template_name` varchar(255) COLLATE utf8_unicode_ci NOT NULL DEFAULT '' COMMENT '模板名称',
  `template_type` tinyint(3) NOT NULL DEFAULT '0' COMMENT '模板类型（1：营销；2：通知）',
  `content` text COLLATE utf8_unicode_ci NOT NULL COMMENT '模板内容',
  `operator_user` int(10) DEFAULT NULL COMMENT '操作者',
  `create_time` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT '创建时间',
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;
```



## 消息推送记录

```sql

DROP TABLE IF EXISTS `tbl_sms`;
CREATE TABLE `tbl_sms` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `passenger_phone_number` varchar(16) NOT NULL DEFAULT '' COMMENT '乘客手机号',
  `sms_content` varchar(512) NOT NULL DEFAULT '' COMMENT '短信内容',
  `send_time` datetime NOT NULL COMMENT '发送时间',
  `operator` varchar(255) NOT NULL DEFAULT '' COMMENT '操作人',
  `send_flag` tinyint(1) NOT NULL COMMENT '发送状态 0:失败  1: 成功',
  `send_number` tinyint(1) NOT NULL DEFAULT '0' COMMENT '发送失败次数',
  `create_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `update_time` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1554 DEFAULT CHARSET=utf8mb4;

```